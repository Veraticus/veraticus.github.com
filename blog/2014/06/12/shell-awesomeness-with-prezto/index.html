
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Shell Awesomeness with Prezto - Hi, I&#8217;m Josh Symonds</title>
  <meta name="author" content="Josh Symonds">

  
  <meta name="description" content="As developers, we spend a lot of time in our shells: making them fast and responsive improves our productivity. I play around with a lot of &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://joshsymonds.com/blog/2014/06/12/shell-awesomeness-with-prezto">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Hi, I'm Josh Symonds" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script src="//code.highcharts.com/highcharts.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <script type="text/javascript" src="//use.typekit.net/vkg2ijz.js"></script>
<script type="text/javascript">try{Typekit.load();}catch(e){}</script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script type="text/javascript">
  $.noConflict();
  jQuery(document).ready(function($) {
    var stickyTop = $('nav').offset().top; // returns number
    $(window).scroll(function(){ // scroll event
      var windowTop = $(window).scrollTop(); // returns number
      $('nav').toggleClass('sticky', (stickyTop < windowTop))
    });
  });
</script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-29421607-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body >
  <header role="banner"><hgroup>
  <img id='avatar' src="/images/josh_circle.png" />
  <div class='arrow_box'>
    <h1><a href="/">Hi, I&#8217;m Josh Symonds</a></h1>
    
      <h2>I blog about Ruby on Rails, coding, and servers</h2>
    
  </div>
</hgroup>

</header>
  <nav role="navigation"><div id='navigation'>
  <ul class="subscription" data-subscription="rss">
    <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
    
  </ul>
    
  <form action="https://www.google.com/search" method="get">
    <fieldset role="search">
      <input type="hidden" name="q" value="site:joshsymonds.com" />
      <input class="search" type="text" name="q" results="0" placeholder="Search"/>
    </fieldset>
  </form>
    
  <ul class="main-navigation">
  <li id='logo'><a href="/">Josh Symonds</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/resume/">Resum&#233;</a></li>
</ul>

</div></nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Shell Awesomeness With Prezto</h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-06-12T16:56:11-05:00" pubdate data-updated="true"></time>
        <span class='readtime'>Reading time 5  minutes</span>

        
      </p>
    
  </header>


  <div class="entry-content"><p>As developers, we spend a lot of time in our shells: making them fast and responsive improves our productivity. I play around with a lot of development tools (as I mentioned in <a href="http://joshsymonds.com/blog/2014/01/22/supercharge-your-rails-development-environment/">a previous post</a>) trying to find the best combination of intelligence, responsiveness, and fun. Recently I was investigating alternatives to <a href="https://github.com/robbyrussell/oh-my-zsh">oh-my-zsh</a>, which is a wonderful set of Zsh packages but suffers from weird slowdowns and, unfortunately, requires a lot of configuration. I stumbled upon <a href="https://github.com/sorin-ionescu/prezto">prezto</a> and I love it &ndash; originally an optimized fork of oh-my-zsh, it&rsquo;s now its own project, and it is fast, beautiful, and leverages the full power of Zsh. It looks like this:</p>

<p><img src="http://veratic.us/image/300y2o0a3t03/screenie.png" alt="Terminal" /></p>

<p>You should get it. And when you do, use these configuration settings to make your experience even better.</p>

<!-- more -->


<h2>Customize your .zpreztorc</h2>

<p>You&rsquo;ll want to enable a bunch of modules in your <code>.zpreztorc</code>, which is the configuration file for everything prezto. Here&rsquo;s my modules:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="c"># Set the Prezto modules to load (browse modules).</span>
</span><span class='line'><span class="c"># The order matters.</span>
</span><span class='line'>zstyle <span class="s1">&#39;:prezto:load&#39;</span> pmodule <span class="se">\</span>
</span><span class='line'>  <span class="s1">&#39;environment&#39;</span> <span class="se">\</span>
</span><span class='line'>  <span class="s1">&#39;terminal&#39;</span> <span class="se">\</span>
</span><span class='line'>  <span class="s1">&#39;editor&#39;</span> <span class="se">\</span>
</span><span class='line'>  <span class="s1">&#39;history&#39;</span> <span class="se">\</span>
</span><span class='line'>  <span class="s1">&#39;directory&#39;</span> <span class="se">\</span>
</span><span class='line'>  <span class="s1">&#39;spectrum&#39;</span> <span class="se">\</span>
</span><span class='line'>  <span class="s1">&#39;utility&#39;</span> <span class="se">\</span>
</span><span class='line'>  <span class="s1">&#39;ssh&#39;</span> <span class="se">\</span>
</span><span class='line'>  <span class="s1">&#39;completion&#39;</span> <span class="se">\</span>
</span><span class='line'>  <span class="s1">&#39;homebrew&#39;</span> <span class="se">\</span>
</span><span class='line'>  <span class="s1">&#39;osx&#39;</span> <span class="se">\</span>
</span><span class='line'>  <span class="s1">&#39;ruby&#39;</span> <span class="se">\</span>
</span><span class='line'>  <span class="s1">&#39;rails&#39;</span> <span class="se">\</span>
</span><span class='line'>  <span class="s1">&#39;git&#39;</span> <span class="se">\</span>
</span><span class='line'>  <span class="s1">&#39;syntax-highlighting&#39;</span> <span class="se">\</span>
</span><span class='line'>  <span class="s1">&#39;history-substring-search&#39;</span> <span class="se">\</span>
</span><span class='line'>  <span class="s1">&#39;prompt&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>They&rsquo;re not kidding when they say the order matters: <code>prompt</code> must come last, <code>history-substring-search</code> must come before it, and <code>syntax-highlighting</code> must come before that. The result of messing this up will likely be a ton of Zsh errors output to your shell after every command.</p>

<p>Some highlights from this list:</p>

<ul>
<li><p><code>history</code> and <code>history-substring-search</code> work together to bring you one of the most awesome features of zprezto: when you type in a command and press up and down, you&rsquo;ll only get history results of you typing that command. Super helpful for typing in ssh, then going back in time to see your previous ssh servers.</p></li>
<li><p><code>syntax-highlighting</code> gives you some <a href="http://fishshell.com/">fish</a>-style highlights. Executable commands will turn blue, incomplete or unrecognized commands will turn red, folders get underlined&hellip; it provides immediate and visceral visual feedback to what you&rsquo;re entering.</p></li>
<li><p><code>directory</code> gives you some awesome shortcuts for the directory stack: <code>d</code> to see all the directories you&rsquo;ve entered, then the numbers <code>1</code> to <code>9</code> to jump to a previous directory you&rsquo;ve visited.</p></li>
</ul>


<p>And that&rsquo;s just a start. Visit the <a href="https://github.com/sorin-ionescu/prezto/tree/master/modules">prezto modules list</a> and view each individual module&rsquo;s README to learn more about them.</p>

<p>After modules are done, get your identities into the SSH agent! There&rsquo;s a configuration block for that later:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="c"># Set the SSH identities to load into the agent.</span>
</span><span class='line'>zstyle <span class="s1">&#39;:prezto:module:ssh:load&#39;</span> identities <span class="s1">&#39;id_rsa&#39;</span> <span class="s1">&#39;id_rsa.github&#39;</span> <span class="s1">&#39;id_rsa.client1&#39;</span> <span class="s1">&#39;id_rsa.client2&#39;</span> <span class="c"># all the rest of your identities</span>
</span></code></pre></td></tr></table></div></figure>


<p>I also set up a custom theme for myself, the source of which I&rsquo;ll include below. If you want to enable that theme (or a different one), you&rsquo;ll also need to specify it in your <code>.zpreztorc</code>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="c"># Set the prompt theme to load.</span>
</span><span class='line'><span class="c"># Setting it to &#39;random&#39; loads a random theme.</span>
</span><span class='line'><span class="c"># Auto set to &#39;off&#39; on dumb terminals.</span>
</span><span class='line'>zstyle <span class="s1">&#39;:prezto:module:prompt&#39;</span> theme <span class="s1">&#39;josh&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>You can find the full text of my <code>.zpreztorc</code> <a href="https://gist.github.com/Veraticus/a1b5204d8f922de5ea88">as a gist</a>.</p>

<h2>Customize your .zshrc</h2>

<p><code>.zshrc</code> is loaded in every interactive shell: use it to set up your Ruby switcher, important aliases, and anything else you need for maximum awesomeness. Mine is fairly self-explanatory:</p>

<div><script src='https://gist.github.com/79ab3d262305ae2c5aeb.js?file=zshrc.zsh'></script>
<noscript><pre><code>#
# Executes commands at the start of an interactive session.
#
# Authors:
#   Sorin Ionescu &lt;sorin.ionescu@gmail.com&gt;
#

# Source Prezto.
if [[ -s &quot;${ZDOTDIR:-$HOME}/.zprezto/init.zsh&quot; ]]; then
  source &quot;${ZDOTDIR:-$HOME}/.zprezto/init.zsh&quot;
fi

# Customize to your needs...

# Start rbenv
export PATH=&quot;$HOME/.rbenv/bin:$PATH&quot;
eval &quot;$(rbenv init -)&quot;

# Add homebrew to the completion path
fpath=(&quot;/usr/local/bin/&quot; $fpath)

# why would you type &#39;cd dir&#39; if you could just type &#39;dir&#39;?
setopt AUTO_CD

# Now we can pipe to multiple outputs!
setopt MULTIOS

# This makes cd=pushd
setopt AUTO_PUSHD

# This will use named dirs when possible
setopt AUTO_NAME_DIRS

# If we have a glob this will expand it
setopt GLOB_COMPLETE
setopt PUSHD_MINUS

# No more annoying pushd messages...
# setopt PUSHD_SILENT

# blank pushd goes to home
setopt PUSHD_TO_HOME

# this will ignore multiple directories for the stack.  Useful?  I dunno.
setopt PUSHD_IGNORE_DUPS

# 10 second wait if you do something that will delete everything.  I wish I&#39;d had this before...
setopt RM_STAR_WAIT

# use magic (this is default, but it can&#39;t hurt!)
setopt ZLE

setopt NO_HUP

# only fools wouldn&#39;t do this ;-)
export EDITOR=&quot;subl -n -w&quot;

setopt IGNORE_EOF

# If I could disable Ctrl-s completely I would!
setopt NO_FLOW_CONTROL

# Keep echo &quot;station&quot; &gt; station from clobbering station
setopt NO_CLOBBER

# Case insensitive globbing
setopt NO_CASE_GLOB

# Be Reasonable!
setopt NUMERIC_GLOB_SORT

# I don&#39;t know why I never set this before.
setopt EXTENDED_GLOB

# hows about arrays be awesome?  (that is, frew${cool}frew has frew surrounding all the variables, not just first and last
setopt RC_EXPAND_PARAM

# Who doesn&#39;t want home and end to work?
bindkey &#39;\e[1~&#39; beginning-of-line
bindkey &#39;\e[4~&#39; end-of-line

# Incremental search is elite!
bindkey -M vicmd &quot;/&quot; history-incremental-search-backward
bindkey -M vicmd &quot;?&quot; history-incremental-search-forward

# Search based on what you typed in already
bindkey -M vicmd &quot;//&quot; history-beginning-search-backward
bindkey -M vicmd &quot;??&quot; history-beginning-search-forward

bindkey &quot;\eOP&quot; run-help

# oh wow!  This is killer...  try it!
bindkey -M vicmd &quot;q&quot; push-line

# it&#39;s like, space AND completion.  Gnarlbot.
bindkey -M viins &#39; &#39; magic-space
</code></pre></noscript></div>


<h2>Select your theme</h2>

<p>There are a lot of cool themes out there. But I was pretty used to my old Zsh theme, which was simple, clean, and had an obvious indicator when your last command failed. For an example of what it looks like, see the screenshot at the start of this post.</p>

<p>The arrow on the left shows green when your last exit code was 0, and red when it was 1. It includes the branch you&rsquo;re on, with an indicator of whether you have uncommitted files on the right-hand side. It does a ton more as well, and here&rsquo;s the source for your use:</p>

<div><script src='https://gist.github.com/1b30a6b6cbe8dae57e9f.js?file=prompt_josh_setup.zsh'></script>
<noscript><pre><code>#
# A stripped-down sorin theme.
#
# Authors:
#   Sorin Ionescu &lt;sorin.ionescu@gmail.com&gt;
#   Josh Symonds &lt;josh@joshsymonds.com&gt;
#
# Screenshots:
#   http://i.imgur.com/nBEEZ.png
#

# Load dependencies.
pmodload &#39;helper&#39;

function prompt_josh_pwd {
  local pwd=&quot;${PWD/#$HOME/~}&quot;

  if [[ &quot;$pwd&quot; == (#m)[/~] ]]; then
    _prompt_josh_pwd=&quot;$MATCH&quot;
    unset MATCH
  else
    _prompt_josh_pwd=&quot;${${${(@j:/:M)${(@s:/:)pwd}##.#?}:h}%/}/${pwd:t}&quot;
  fi
}

function prompt_josh_precmd {
  setopt LOCAL_OPTIONS
  unsetopt XTRACE KSH_ARRAYS

  # Format PWD.
  prompt_josh_pwd

  # Get Git repository information.
  if (( $+functions[git-info] )); then
    git-info
  fi

  # Get ruby information
  if (( $+functions[ruby-info] )); then
    ruby-info
  fi
}

function prompt_josh_setup {
  setopt LOCAL_OPTIONS
  unsetopt XTRACE KSH_ARRAYS
  prompt_opts=(cr percent subst)

  # Load required functions.
  autoload -Uz add-zsh-hook

  # Add hook for calling git-info before each command.
  add-zsh-hook precmd prompt_josh_precmd

  # Set editor-info parameters.
  zstyle &#39;:prezto:module:editor:info:completing&#39; format &#39;%B%F{red}...%f%b&#39;
  zstyle &#39;:prezto:module:editor:info:keymap:primary&#39; format &#39;%B%(?;%{%F{green}%} ;%{%F{red}%} )❯%f%b&#39;
  zstyle &#39;:prezto:module:editor:info:keymap:primary:overwrite&#39; format &#39; %F{red}♺%f&#39;
  zstyle &#39;:prezto:module:editor:info:keymap:alternate&#39; format &#39; %B%F{green}❮%F{yellow}❮%F{red}❮%f%b&#39;

  # Set git-info parameters.
  zstyle &#39;:prezto:module:git:info&#39; verbose &#39;yes&#39;
  zstyle &#39;:prezto:module:git:info:action&#39; format &#39;:%%B%F{yellow}%s%f%%b&#39;
  zstyle &#39;:prezto:module:git:info:added&#39; format &#39; %%B%F{green}✚%f%%b&#39;
  zstyle &#39;:prezto:module:git:info:ahead&#39; format &#39; %%B%F{yellow}⬆%f%%b&#39;
  zstyle &#39;:prezto:module:git:info:behind&#39; format &#39; %%B%F{yellow}⬇%f%%b&#39;
  zstyle &#39;:prezto:module:git:info:branch&#39; format &#39;%F{green}%b%f&#39;
  zstyle &#39;:prezto:module:git:info:commit&#39; format &#39;:%F{green}%.7c%f&#39;
  zstyle &#39;:prezto:module:git:info:deleted&#39; format &#39; %%B%F{red}✖%f%%b&#39;
  zstyle &#39;:prezto:module:git:info:modified&#39; format &#39; %%B%F{blue}✱%f%%b&#39;
  zstyle &#39;:prezto:module:git:info:position&#39; format &#39;:%F{red}%p%f&#39;
  zstyle &#39;:prezto:module:git:info:renamed&#39; format &#39; %%B%F{magenta}➜%f%%b&#39;
  zstyle &#39;:prezto:module:git:info:stashed&#39; format &#39; %%B%F{cyan}✭%f%%b&#39;
  zstyle &#39;:prezto:module:git:info:unmerged&#39; format &#39; %%B%F{yellow}═%f%%b&#39;
  zstyle &#39;:prezto:module:git:info:untracked&#39; format &#39; %%B%F{white}◼%f%%b&#39;
  zstyle &#39;:prezto:module:git:info:keys&#39; format \
    &#39;prompt&#39; &#39; $(coalesce &quot;%b&quot; &quot;%p&quot; &quot;%c&quot;)%s&#39; \
    &#39;rprompt&#39; &#39;%A%B%S%a%d%m%r%U%u&#39;

  # Define prompts.
  PROMPT=&#39;%F{cyan}${_prompt_josh_pwd}%f${git_info:+${(e)git_info[prompt]}}%(!. %B%F{red}#%f%b.)${editor_info[keymap]} &#39;
  RPROMPT=&#39;${editor_info[overwrite]}${VIM:+&quot; %B%F{green}V%f%b&quot;}${git_info[rprompt]}&#39;
  SPROMPT=&#39;zsh: correct %F{red}%R%f to %F{green}%r%f [nyae]? &#39;
}

prompt_josh_setup &quot;$@&quot;

</code></pre></noscript></div>


<p>Place this in <code>~/.zprezto/modules/prompt/functions/prompt_josh_setup</code> and then select it in your <code>.zpretorc</code> for best results.</p>

<p>prezto is easy to configure and presents a lot of powerful options: you&rsquo;ll want to spend some time getting used to it. But it&rsquo;s also really enjoyable. Once you start learning the power behind your shell and how easy it becomes to access, I guarantee that you&rsquo;ll never look back.</p>
</div>
  <div class='attribution'>
  <p>Josh Symonds performs devops and server wrangling on cloud-scale infrastructures, deploys amazing web applications with Ruby on Rails, and creates awesome iOS apps with Objective-C and RubyMotion. He is founder and CTO of <a href='http://symondsandson.com'>Symonds &amp; Son</a>, a development shop focused on quality and excellence.</p>
  <img src="/images/josh.png" width='200' height='188' alt='Josh Symonds'/>
  <ul class='icons'>
    <li><i class="fa fa-phone"></i> 773-480-4810</li>
    <li><i class="fa fa-envelope"></i> <a href='mailto:josh@joshsymonds.com?Subject=Hi&nbsp;Josh!'>josh@joshsymonds.com</a></li>
    <li><i class="fa fa-link"></i> <a href='http://joshsymonds.com'>joshsymonds.com</a></li>
    <li><a href='https://github.com/Veraticus'><i class="fa fa-github"></i> github.com/Veraticus</a></li>
    <li><a href='https://twitter.com/Veraticus'><i class="fa fa-twitter"></i> twitter.com/Veraticus</a></li>
  </ul>
</div>



  <footer>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://joshsymonds.com/blog/2014/06/12/shell-awesomeness-with-prezto/" data-via="Veraticus" data-counturl="http://joshsymonds.com/blog/2014/06/12/shell-awesomeness-with-prezto/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2014/06/11/getting-started-with-aws-opsworks/" title="Previous Post: Getting Started With AWS OpsWorks">&laquo; Getting Started With AWS OpsWorks</a>
      
      
        <a class="basic-alignment right" href="/blog/2014/06/15/your-job-is-to-code/" title="Next Post: Your Job Is To Code">Your Job Is To Code &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

    </div>
  </div>
  <footer role="contentinfo"><div id='footer'>
  <p>
  Copyright &copy; 2016 - Josh Symonds -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</div>
</footer>
  



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
